load("nhanes9904_VoE.Rdata")
ls()
dictionary
mainTab
head(mainTab)
head(dictionary)
str(dictionary)
str(mainTab)
dat <- mainTab[, c('MORTSTAT', 'SDDSRVYR', 'WTMEC4YR', 'PERMTH_EXM', 'SES_LEVEL', 'RIDAGEYR', 'male', 'area', 'LBXT4', 'current_past_smoking', 'any_cad', 'any_family_cad', 'any_cancer_self_report', 'bmi', 'any_ht', 'any_diabetes', 'education', 'RIDRETH1', 'physical_activity', 'drink_five_per_day', 'LBXTC' )]
## set of adjusting variables
#covariates <- ~ factor(current_past_smoking, levels=c(0,1,2)) + factor(SES_LEVEL, levels=c(2, 1, 0)) + any_cad + any_ht + any_diabetes + factor(education, levels=c(3,2,1)) + factor(RIDRETH1, levels=c(3, 1,2, 4, 5))
covariates <- ~ as.factor(SES_LEVEL) + as.factor(education) + as.factor(RIDRETH1) + as.factor(bmi) + any_cad + any_family_cad + any_diabetes + any_cancer_self_report +  current_past_smoking  + drink_five_per_day + physical_activity  + LBXTC + any_ht
## base model is Cadmium (LBXBCD), age, sex; cluster(area) is to account for the correlated observations in NHANES
#basemodel <- Surv(PERMTH_EXM, MORTSTAT) ~ scale(I(log(LBXBCD+.1))) + RIDAGEYR + male + cluster(area)
basemodel <- Surv(PERMTH_EXM, MORTSTAT) ~ scale(I(log(LBXT4+.1))) + RIDAGEYR + male + cluster(area)
## compute vibration for LBXBCD, serum levels of the heavy metal cadmium, in association with time to death
dat <- subset(dat, !is.na(WTMEC4YR))
dat <- dat[complete.cases(dat), ]
dat
str(dat)
dat$PERMTH_EXM
dim(dat)
str(dat)
summary(dat$SDDSRVYR)
unique(dat$SDDSRCYR)
unique(dat$SDDSRVYR)
dat |> str()
# Prepare data for python Berkson-Code:
# Python-Code does not alter factor / string variables --> make sure all factor variables are actually factors / strings
# Keep only truly numerical values as numerics
str(dat)
names(dat)
str(dat)
factor_vars = c(
# -- Survival Indicator
# "MORTSTAT",
# -- Data set indicator
"SDDSRVYR",
# -- Exam sample weight (combined)
# "WTMEC4YR",
# -- Follow-up time in month
# i.e. this is "time" variable
# "PERMTH_EXM",
# -- socioecnomic status level
"SES_LEVEL",
# -- Age at screening
# "RIDAGEYR",
# -- Is sex male
"male",
# -- Area of where subject lives
"area",
# -- Serum total thyroxine (mycro gram / dL)
# "LBXT4",
# -- Factor if current or past smoking
"current_past_smoking",
# -- Indicator for coronary artery disease
"any_cad",
# -- Indicator that any family member has had heart attack or angina
"any_family_cad",
# -- Indicator if any cancer self report
"any_cancer_self_report",
# -- BMI of subject
# "bmi",
# -- Indicator if any hyptertension
"any_ht",
# -- Indicator if patient has diabetes
"any_diabetes",
# -- Categorical level of education
"education",
# -- ethnicity of subject
"RIDRETH1",
# -- Ranking of physical activity
"physical_activity",
# -- Indicator for heavy drinking
"drink_five_per_day"
# -- Serum total cholesterol mg/dL
# "LBXTC"
)
factor_vars = c(
# -- Survival Indicator
# "MORTSTAT",
# -- Data set indicator
"SDDSRVYR",
# -- Exam sample weight (combined)
# "WTMEC4YR",
# -- Follow-up time in month
# i.e. this is "time" variable
# "PERMTH_EXM",
# -- socioecnomic status level
"SES_LEVEL",
# -- Age at screening
# "RIDAGEYR",
# -- Is sex male
"male",
# -- Area of where subject lives
"area",
# -- Serum total thyroxine (mycro gram / dL)
# "LBXT4",
# -- Factor if current or past smoking
"current_past_smoking",
# -- Indicator for coronary artery disease
"any_cad",
# -- Indicator that any family member has had heart attack or angina
"any_family_cad",
# -- Indicator if any cancer self report
"any_cancer_self_report",
# -- BMI of subject
# "bmi",
# -- Indicator if any hyptertension
"any_ht",
# -- Indicator if patient has diabetes
"any_diabetes",
# -- Categorical level of education
"education",
# -- ethnicity of subject
"RIDRETH1",
# -- Ranking of physical activity
"physical_activity",
# -- Indicator for heavy drinking
"drink_five_per_day"
# -- Serum total cholesterol mg/dL
# "LBXTC"
)
dat[, factor_vars]
dat[, factor_vars] = as.character(dat[, factor_vars])
dat[, factor_vars]
# Following data obtained from paper's github: https://github.com/chiragjp/voe
load("nhanes9904_VoE.Rdata")
# Following copy-pasta from: voe/vibration/vibration_start.R
dat <- mainTab[, c('MORTSTAT', 'SDDSRVYR', 'WTMEC4YR', 'PERMTH_EXM', 'SES_LEVEL', 'RIDAGEYR', 'male', 'area', 'LBXT4', 'current_past_smoking', 'any_cad', 'any_family_cad', 'any_cancer_self_report', 'bmi', 'any_ht', 'any_diabetes', 'education', 'RIDRETH1', 'physical_activity', 'drink_five_per_day', 'LBXTC' )]
## base model is Cadmium (LBXBCD), age, sex; cluster(area) is to account for the correlated observations in NHANES
basemodel <- Surv(PERMTH_EXM, MORTSTAT) ~ scale(I(log(LBXT4+.1))) + RIDAGEYR + male + cluster(area)
## compute vibration for LBXBCD, serum levels of the heavy metal cadmium, in association with time to death
dat <- subset(dat, !is.na(WTMEC4YR))
dat <- dat[complete.cases(dat), ]
# Prepare data for python Berkson-Code:
# Python-Code does not alter factor / string variables --> make sure all factor variables are actually factors / strings
# Keep only truly numerical values as numerics
str(dat)
factor_vars = c(
# -- Survival Indicator
# "MORTSTAT",
# -- Data set indicator
"SDDSRVYR",
# -- Exam sample weight (combined)
# "WTMEC4YR",
# -- Follow-up time in month
# i.e. this is "time" variable
# "PERMTH_EXM",
# -- socioecnomic status level
"SES_LEVEL",
# -- Age at screening
# "RIDAGEYR",
# -- Is sex male
"male",
# -- Area of where subject lives
"area",
# -- Serum total thyroxine (mycro gram / dL)
# "LBXT4",
# -- Factor if current or past smoking
"current_past_smoking",
# -- Indicator for coronary artery disease
"any_cad",
# -- Indicator that any family member has had heart attack or angina
"any_family_cad",
# -- Indicator if any cancer self report
"any_cancer_self_report",
# -- BMI of subject
# "bmi",
# -- Indicator if any hyptertension
"any_ht",
# -- Indicator if patient has diabetes
"any_diabetes",
# -- Categorical level of education
"education",
# -- ethnicity of subject
"RIDRETH1",
# -- Ranking of physical activity
"physical_activity",
# -- Indicator for heavy drinking
"drink_five_per_day"
# -- Serum total cholesterol mg/dL
# "LBXTC"
)
csv.write2("voe_data.csv", sep = ";")
write.csv2("voe_data.csv", sep = ";")
write.csv2("voe_data.csv")
# Following data obtained from paper's github: https://github.com/chiragjp/voe
load("../data/nhanes9904_VoE.Rdata")
# Following copy-pasta from: voe/vibration/vibration_start.R
dat <- mainTab[, c('MORTSTAT', 'SDDSRVYR', 'WTMEC4YR', 'PERMTH_EXM', 'SES_LEVEL', 'RIDAGEYR', 'male', 'area', 'LBXT4', 'current_past_smoking', 'any_cad', 'any_family_cad', 'any_cancer_self_report', 'bmi', 'any_ht', 'any_diabetes', 'education', 'RIDRETH1', 'physical_activity', 'drink_five_per_day', 'LBXTC' )]
## base model is Cadmium (LBXBCD), age, sex; cluster(area) is to account for the correlated observations in NHANES
basemodel <- Surv(PERMTH_EXM, MORTSTAT) ~ scale(I(log(LBXT4+.1))) + RIDAGEYR + male + cluster(area)
## compute vibration for LBXBCD, serum levels of the heavy metal cadmium, in association with time to death
dat <- subset(dat, !is.na(WTMEC4YR))
dat <- dat[complete.cases(dat), ]
# Prepare data for python Berkson-Code:
# Python-Code does not alter factor / string variables --> make sure all factor variables are actually factors / strings
# Keep only truly numerical values as numerics
str(dat)
factor_vars = c(
# -- Survival Indicator
# "MORTSTAT",
# -- Data set indicator
"SDDSRVYR",
# -- Exam sample weight (combined)
# "WTMEC4YR",
# -- Follow-up time in month
# i.e. this is "time" variable
# "PERMTH_EXM",
# -- socioecnomic status level
"SES_LEVEL",
# -- Age at screening
# "RIDAGEYR",
# -- Is sex male
"male",
# -- Area of where subject lives
"area",
# -- Serum total thyroxine (mycro gram / dL)
# "LBXT4",
# -- Factor if current or past smoking
"current_past_smoking",
# -- Indicator for coronary artery disease
"any_cad",
# -- Indicator that any family member has had heart attack or angina
"any_family_cad",
# -- Indicator if any cancer self report
"any_cancer_self_report",
# -- BMI of subject
# "bmi",
# -- Indicator if any hyptertension
"any_ht",
# -- Indicator if patient has diabetes
"any_diabetes",
# -- Categorical level of education
"education",
# -- ethnicity of subject
"RIDRETH1",
# -- Ranking of physical activity
"physical_activity",
# -- Indicator for heavy drinking
"drink_five_per_day"
# -- Serum total cholesterol mg/dL
# "LBXTC"
)
write.csv2("voe_data.csv")
dat
dim(dat)
getwd()
write.csv2("voe_data.csv")
?write.csv2
write.csv2(dat, "voe_data.csv", sep = ";")
write.csv2(dat, "../data/voe_data.csv", sep = ";")
write.csv2(dat, "../data/voe_data.csv", sep = ";", row.names = FALSE)
mainTab
dat
dat$LBXT4
write.csv2(dat, "../data/voe_data.csv", sep = ";", row.names = FALSE)
write.csv2(dat, "../data/voe_data.csv", sep = ";", row.names = FALSE, dec = ".")
write.table(
dat,
"../data/voe_data.csv",
sep = ";",
row.names = FALSE,
dec = "."
)
